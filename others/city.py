#coding:utf-8
from geopy.geocoders import Nominatim
from others.wordtopinyin import change
from getdata.insertdb import insertall
import numpy as np

PROVINCE = (
 (1, '北京市'),
 (2, '上海市'),
 (3, '香港'),
 (4, '台湾'),
 (5, '重庆市'),
 (6, '澳门'),
 (7, '天津市'),
 (8, '江苏省'),
 (9, '浙江省'),
 (10, '四川省'),
 (11, '江西省'),
 (12, '福建省'),
 (13, '青海省'),
 (14, '吉林省'),
 (15, '贵州省'),
 (16, '陕西省'),
 (17, '山西省'),
 (18, '河北省'),
 (19, '湖北省'),
 (20, '辽宁省'),
 (21, '湖南省'),
 (22, '山东省'),
 (23, '云南省'),
 (24, '河南省'),
 (25, '广东省'),
 (26, '安徽省'),
 (27, '甘肃省'),
 (28, '海南省'),
 (29, '黑龙江省'),
 (30, '内蒙古自治区'),
 (31, '新疆维吾尔自治区'),
 (32, '广西壮族自治区'),
 (33, '宁夏回族自治区'),
 (34, '西藏自治区')
)
PROVINCE_DICT = dict(PROVINCE)

CITY = {
 8: ((1, '常州市'),
     (2, '连云港市'),
     (3, '泰州市'),
     (4, '南京市'),
     (5, '扬州市'),
     (6, '镇江市'),
     (7, '宿迁市'),
     (8, '盐城市'),
     (9, '徐州市'),
     (10, '南通市'),
     (11, '淮安市'),
     (12, '无锡市'),
     (13, '苏州市')),
 9: ((14, '湖州市'),
     (15, '杭州市'),
     (16, '舟山市'),
     (17, '嘉兴市'),
     (18, '衢州市'),
     (19, '金华市'),
     (20, '宁波市'),
     (21, '台州市'),

     (24, '绍兴市')),
 10: ((25, '广元市'),
      (26, '凉山彝族自治州'),
      (27, '绵阳市'),
      (28, '资阳市'),
      (29, '巴中市'),
      (30, '德阳市'),
      (31, '眉山市'),
      (32, '甘孜藏族自治州'),
      (33, '成都市'),
      (34, '乐山市'),
      (35, '阿坝藏族羌族自治州'),
      (36, '内江市'),
      (37, '自贡市'),
      (38, '攀枝花市'),
      (39, '达州市'),
      (40, '宜宾市'),
      (41, '泸州市'),
      (42, '遂宁市'),
      (43, '雅安市'),
      (44, '南充市'),
      (45, '广安市')),
 11: ((46, '赣州市'),
      (47, '上饶市'),
      (48, '宜春市'),
      (49, '抚州市'),
      (50, '新余市'),
      (51, '吉安市'),
      (52, '南昌市'),
      (53, '鹰潭市'),
      (54, '景德镇市'),
      (55, '九江市'),
      (56, '萍乡市')),
 12: ((57, '宁德市'),
      (58, '三明市'),
      (59, '福州市'),
      (60, '南平市'),
      (61, '龙岩市'),
      (62, '莆田市'),
      (63, '泉州市'),
      (64, '漳州市')),
 13: ((65, '西宁市'),
      (66, '果洛藏族自治州'),
      (67, '海东地区'),
      (68, '黄南藏族自治州'),
      (69, '海南藏族自治州'),
      (70, '海北藏族自治州'),
      (71, '玉树藏族自治州'),
      (72, '海西蒙古族藏族自治州')),
 14: ((73, '辽源市'),
      (74, '延边朝鲜族自治州'),
      (75, '白城市'),
      (76, '四平市'),
      (77, '长春市'),
      (78, '通化市'),
      (79, '吉林市'),
      (80, '白山市'),
      (81, '松原市')),
 15: ((82, '黔南布依族苗族自治州'),
      (83, '六盘水市'),
      (84, '贵阳市'),
      (85, '遵义市'),
      (86, '铜仁地区'),
      (87, '毕节地区'),
      (88, '安顺市'),
      (89, '黔东南苗族侗族自治州'),
      (90, '黔西南布依族苗族自治州')),
 16: ((91, '西安市'),
      (92, '延安市'),
      (93, '汉中市'),
      (94, '宝鸡市'),
      (95, '榆林市'),
      (96, '渭南市'),
      (97, '咸阳市'),
      (98, '安康市'),
      (99, '铜川市'),
      (100, '商洛市')),
 17: ((101, '晋城市'),
      (102, '晋中市'),
      (103, '阳泉市'),
      (104, '忻州市'),
      (105, '朔州市'),
      (106, '大同市'),
      (107, '运城市'),
      (108, '太原市'),
      (109, '吕梁市'),
      (110, '临汾市'),
      (111, '长治市')),
 18: ((112, '廊坊市'),
      (113, '衡水市'),
      (114, '邢台市'),
      (115, '石家庄市'),
      (116, '沧州市'),
      (117, '保定市'),
      (118, '邯郸市'),
      (119, '张家口市'),
      (120, '承德市'),
      (121, '唐山市'),
      (122, '秦皇岛市')),
 19: ((123, '荆门市'),
      (124, '十堰市'),
      (125, '荆州市'),
      (126, '恩施土家族苗族自治州'),
      (127, '随州市'),
      (128, '黄冈市'),
      (129, '咸宁市'),
      (130, '宜昌市'),
      (131, '襄樊市'),
      (132, '孝感市'),
      (133, '黄石市')),
 20: ((134, '营口市'),
      (135, '沈阳市'),
      (136, '辽阳市'),
      (137, '大连市'),
      (138, '朝阳市'),
      (139, '抚顺市'),
      (140, '本溪市'),
      (141, '鞍山市'),
      (142, '葫芦岛市'),
      (143, '盘锦市'),
      (144, '丹东市'),
      (145, '锦州市'),
      (146, '阜新市'),
      (147, '铁岭市')),
 21: ((148, '怀化市'),
      (149, '长沙市'),
      (150, '常德市'),
      (151, '岳阳市'),
      (152, '株洲市'),
      (153, '湘西土家族苗族自治州'),
      (154, '张家界市'),
      (155, '湘潭市'),
      (156, '益阳市'),
      (157, '娄底市'),
      (158, '衡阳市'),
      (159, '郴州市'),
      (160, '永州市'),
      (161, '邵阳市')),
 22: ((162, '枣庄市'),
      (163, '德州市'),
      (164, '济南市'),
      (165, '济宁市'),
      (166, '菏泽市'),
      (167, '滨州市'),
      (168, '烟台市'),
      (169, '潍坊市'),
      (170, '聊城市'),
      (171, '日照市'),
      (172, '泰安市'),
      (173, '东营市'),
      (174, '临沂市'),
      (175, '青岛市'),
      (176, '威海市'),
      (177, '淄博市')),
 23: ((178, '玉溪市'),
      (179, '曲靖市'),
      (180, '西双版纳傣族自治州'),
      (181, '文山壮族苗族自治州'),
      (182, '德宏傣族景颇族自治州'),
      (183, '保山市'),
      (184, '昭通市'),
      (185, '迪庆藏族自治州'),
      (186, '普洱市'),
      (187, '昆明市'),
      (188, '丽江市'),
      (189, '楚雄彝族自治州'),
      (190, '红河哈尼族彝族自治州'),
      (191, '临沧市'),
      (192, '怒江傈僳族自治州'),
      (193, '大理白族自治州')),
 24: ((194, '新乡市'),
      (195, '驻马店市'),
      (196, '南阳市'),
      (197, '漯河市'),
      (198, '安阳市'),
      (199, '平顶山市'),
      (200, '商丘市'),
      (201, '开封市'),
      (202, '郑州市'),
      (203, '濮阳市'),
      (204, '三门峡市'),
      (205, '周口市'),
      (206, '焦作市'),
      (207, '信阳市'),
      (208, '许昌市'),
      (209, '洛阳市')),
 25: ((210, '广州市'),
      (211, '湛江市'),
      (212, '汕尾市'),
      (213, '汕头市'),
      (214, '梅州市'),
      (215, '云浮市'),
      (216, '阳江市'),
      (217, '清远市'),
      (218, '茂名市'),
      (219, '揭阳市'),
      (220, '惠州市'),
      (221, '潮州市'),
      (222, '河源市'),
      (223, '韶关市'),
      (224, '肇庆市'),
      (225, '江门市')),
 26: ((226, '六安市'),
      (227, '淮南市'),
      (228, '铜陵市'),
      (229, '宣城市'),
      (230, '阜阳市'),
      (231, '宿州市'),
      (232, '滁州市'),
      (233, '黄山市'),
      (234, '蚌埠市'),
      (235, '淮北市'),
      (236, '安庆市'),
      (237, '亳州市'),
      (238, '马鞍山市'),
      (239, '巢湖市'),
      (240, '芜湖市'),
      (241, '池州市'),
      (242, '合肥市')),
 27: ((243, '临夏回族自治州'),
      (244, '白银市'),
      (245, '陇南市'),
      (246, '金昌市'),
      (247, '兰州市'),
      (248, '武威市'),
      (249, '定西市'),
      (250, '酒泉市'),
      (251, '甘南藏族自治州'),
      (252, '庆阳市'),
      (253, '天水市'),
      (254, '张掖市'),
      (255, '平凉市')),
 29: ((256, '齐齐哈尔市'),
      (257, '大兴安岭地区'),
      (258, '鸡西市'),
      (259, '黑河市'),
      (260, '佳木斯市'),
      (261, '哈尔滨市'),
      (262, '牡丹江市'),
      (263, '双鸭山市'),
      (264, '七台河市'),
      (265, '大庆市'),
      (266, '绥化市'),
      (267, '伊春市'),
      (268, '鹤岗市')),
 30: ((269, '兴安盟'),
      (270, '呼伦贝尔市'),
      (271, '乌兰察布市'),
      (272, '巴彦淖尔市'),
      (273, '锡林郭勒盟'),
      (274, '鄂尔多斯市'),
      (275, '通辽市'),
      (276, '赤峰市'),
      (277, '呼和浩特市'),
      (278, '阿拉善盟'),
      (279, '包头市')),
 31: ((280, '伊犁哈萨克自治州'),
      (281, '博尔塔拉蒙古自治州'),
      (282, '巴音郭楞蒙古自治州'),
      (283, '乌鲁木齐市'),
      (284, '和田地区'),
      (285, '喀什地区'),
      (286, '哈密地区'),
      (287, '阿勒泰地区'),
      (288, '克孜勒苏柯尔克孜自治州'),
      (289, '昌吉回族自治州'),
      (290, '阿克苏地区'),
      (291, '吐鲁番'),
      (292, '塔城')),
 32: ((293, '贵港市'),
      (294, '河池市'),
      (295, '贺州市'),
      (296, '柳州市'),
      (297, '北海市'),
      (298, '玉林市'),
      (299, '桂林市'),
      (300, '百色市'),
      (301, '钦州市'),
      (302, '梧州市'),
      (303, '来宾市'),
      (304, '崇左市'),
      (305, '南宁市'),
      (306, '防城港市')),
 33: ((307, '石嘴山市'),
      (308, '中卫市'),
      (309, '吴忠市'),
      (310, '固原市'),
      (311, '银川市')),
 34: ((312, '那曲地区'),
      (313, '昌都地区'),
      (314, '拉萨市'),
      (315, '山南地区'),
      (316, '林芝地区'),
      (317, '日喀则地区'),
      (318, '阿里地区'))
}

#获取经纬度
def getposition(address):
    gps = Nominatim()
    location = gps.geocode(address,timeout=10000)
    return location.longitude, location.latitude

#获取城市
def getcity():
  #  sql=[]
    for i in PROVINCE_DICT:
        p=PROVINCE_DICT[i]
        t = CITY.get(i, ())
        if(len(t)==0):
            c=PROVINCE_DICT[i]
            piny=change(c)
            po=getposition(c)
            lon=po[0]
            lat=po[1]
            strsql = "INSERT INTO citydata(province,city,pinyin,jingdu,weidu) VALUES ('%s', '%s','%s',%f,%f )" % (p, c,piny,lon,lat)
            strsql+=";"
            insertall(strsql)
        else:
            for j in range(len(t)):
                c=t[j][1]
                piny = change(c)
                po = getposition(c)
                lon = po[0]
                lat = po[1]
                strsql = "INSERT INTO citydata(province,city,pinyin,jingdu,weidu) VALUES ('%s', '%s','%s',%f,%f )" % (p, c, piny, lon, lat)
                strsql+=";"
                insertall(strsql)

if __name__=='__main__':
    getcity()